<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¹ãƒ­ãƒƒãƒˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;800&display=swap');

        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #2d3748; /* ãƒ€ãƒ¼ã‚¯ãªèƒŒæ™¯ã§ãƒã‚·ãƒ³ã‚’å¼•ãç«‹ã¦ã‚‹ */
            color: #333;
            overflow: hidden;
        }

        /* ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³æœ¬ä½“ */
        .slot-machine {
            background: linear-gradient(135deg, #FFD700, #FDB931);
            border-radius: 30px;
            padding: 20px;
            box-shadow: 
                0 10px 0 #b38806, 
                0 20px 30px rgba(0,0,0,0.5),
                inset 0 0 20px rgba(255,255,255,0.5);
            width: 340px;
            margin: 0 auto;
            position: relative;
        }

        /* ç”»é¢æ  */
        .screen-frame {
            background: #222;
            padding: 15px;
            border-radius: 15px;
            box-shadow: inset 0 5px 10px rgba(0,0,0,0.8);
            position: relative;
            overflow: hidden;
        }

        /* ãƒªãƒ¼ãƒ«ã®è¡¨ç¤ºçª“ */
        .reel-window {
            height: 120px; /* æ–‡å­—1ã¤åˆ†ã®é«˜ã•ã«åˆã‚ã›ã‚‹ */
            background: white;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 15px rgba(0,0,0,0.3);
            border: 2px solid #555;
        }

        /* ã‚»ãƒ³ã‚¿ãƒ¼ãƒ©ã‚¤ãƒ³ï¼ˆå½“ãŸã‚Šã®ä½ç½®ï¼‰ */
        .center-line {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 0, 0, 0.3);
            transform: translateY(-50%);
            z-index: 10;
            pointer-events: none;
            box-shadow: 0 0 5px rgba(255,0,0,0.5);
        }
        /* ä¸‰è§’ã®ç›®å° */
        .center-line::before, .center-line::after {
            content: 'â—€';
            position: absolute;
            top: 50%;
            right: 5px;
            transform: translateY(-50%);
            color: red;
            font-size: 20px;
        }
        .center-line::before {
            content: 'â–¶';
            left: 5px;
            right: auto;
        }

        /* ãƒªãƒ¼ãƒ«ï¼ˆå‹•ãéƒ¨åˆ†ï¼‰ */
        .reel-container {
            width: 100%;
            text-align: center;
            transform: translateY(0); /* åˆæœŸä½ç½® */
        }

        .reel-item {
            height: 120px; /* windowã¨åŒã˜é«˜ã• */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 800;
            color: #333;
            border-bottom: 1px solid #eee;
            box-sizing: border-box;
            padding: 0 20px;
        }

        /* åˆæœŸçŠ¶æ…‹ã®éš ã—ã‚«ãƒãƒ¼ */
        .cover-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: bold;
            color: #ddd;
            z-index: 5;
            transition: opacity 0.3s;
        }

        /* å›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes slotScroll {
            0% { transform: translateY(0); }
            100% { transform: translateY(-50%); } /* ãƒªãƒ¼ãƒ«ã‚’2ã‚»ãƒƒãƒˆç©ã‚“ã§åŠåˆ†ã¾ã§å‹•ã‹ã™ */
        }

        .spinning .reel-container {
            animation: slotScroll 0.2s linear infinite;
        }
        
        /* å›è»¢ä¸­ã®ãƒ–ãƒ©ãƒ¼ï¼ˆæ–‡å­—ã‚’è¦‹ãˆãªãã™ã‚‹ï¼‰ */
        .spinning .reel-container {
            filter: blur(8px); 
        }

        /* ãƒ¬ãƒãƒ¼ï¼ˆé£¾ã‚Šï¼‰ */
        .lever-base {
            position: absolute;
            right: -40px;
            top: 100px;
            width: 40px;
            height: 80px;
            background: #bbb;
            border-radius: 0 10px 10px 0;
            z-index: -1;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
        }
        .lever-arm {
            position: absolute;
            right: -60px;
            top: 110px;
            width: 20px;
            height: 100px;
            background: linear-gradient(to right, #ccc, #999);
            border-radius: 10px;
            transform-origin: bottom center;
            transform: rotate(-20deg);
            transition: transform 0.3s;
            z-index: -2;
        }
        .lever-ball {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: radial-gradient(circle at 30% 30%, #ff4d4d, #cc0000);
            border-radius: 50%;
            box-shadow: 0 5px 10px rgba(0,0,0,0.3);
        }
        .lever-arm.pulled {
            transform: rotate(20deg) scaleY(0.8);
        }

        /* çµæœè¡¨ç¤ºã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        .result-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        .result-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }
        .result-box {
            background: white;
            padding: 3rem;
            border-radius: 20px;
            text-align: center;
            transform: scale(0.5);
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-width: 90%;
        }
        .result-overlay.show .result-box {
            transform: scale(1);
        }
        
        /* ã‚µãƒ—ãƒ©ã‚¤ã‚ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .surprise-text {
            opacity: 0;
            transform: translateY(20px);
            transition: all 1s ease-out;
            color: #ec4899; /* pink-500 */
            font-weight: bold;
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
        }
        .surprise-text.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* ã‚­ãƒ©ã‚­ãƒ© */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            background-color: #f00;
            animation: fall linear forwards;
            z-index: 90;
        }
        @keyframes fall {
            to { transform: translateY(110vh) rotate(720deg); }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen">

    <h1 class="text-4xl font-extrabold mb-10 text-white tracking-widest text-shadow-lg">
        ğŸ BIRTHDAY SLOT ğŸ
    </h1>

    <div class="slot-machine">
        <!-- ãƒ¬ãƒãƒ¼è£…é£¾ -->
        <div class="lever-base"></div>
        <div id="leverArm" class="lever-arm">
            <div class="lever-ball"></div>
        </div>

        <div class="screen-frame">
            <div class="reel-window">
                <div class="center-line"></div>
                <!-- åˆæœŸçŠ¶æ…‹ã®éš ã—ç”»é¢ -->
                <div id="coverScreen" class="cover-screen">???</div>
                
                <div id="reel" class="reel-container">
                    <!-- JSã§ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <div class="mt-6 flex justify-center">
            <button id="actionBtn" class="bg-red-500 hover:bg-red-600 border-b-4 border-red-700 text-white font-bold py-4 px-10 rounded-full text-2xl shadow-lg transform transition active:scale-95 active:border-b-0 active:translate-y-1 w-full">
                SPIN!
            </button>
        </div>
    </div>

    <div id="status" class="mt-8 text-yellow-400 font-bold text-xl h-8 tracking-wider">
        <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
    </div>

    <!-- çµæœãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="resultOverlay" class="result-overlay">
        <div class="result-box shadow-2xl">
            <p class="text-gray-400 text-lg mb-2">ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</p>
            <h2 class="text-2xl font-bold text-gray-600 mb-4">ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã¯...</h2>
            <div id="finalResult" class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-violet-500 mb-4 py-2">
                ãƒ›ãƒ†ãƒ«å®¿æ³Š
            </div>
            
            <!-- è¿½åŠ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ -->
            <p id="surpriseMessage" class="surprise-text">
                ï¼’æ³Šåˆ†ã®ç€æ›¿ãˆã‚‚æŒã£ã¦ãã¦ã­ï¼
            </p>

            <button onclick="resetGame()" class="bg-gray-800 text-white px-8 py-3 rounded-full hover:bg-gray-700 font-bold transition">
                é–‰ã˜ã‚‹
            </button>
        </div>
    </div>

    <script>
        // è¨­å®š: èª•ç”Ÿæ—¥ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚‰ã—ã„ãƒ©ã‚¤ãƒ³ãƒŠãƒƒãƒ—ï¼ˆè±ªè¯ç‰ˆï¼‰
        const giftItems = [
            'ãƒ›ãƒ†ãƒ«å®¿æ³Š',       // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ (Index 0)
            'é«˜ç´šãƒ‡ã‚£ãƒŠãƒ¼',
            'æ¸©æ³‰æ—…è¡Œ',
            'ãƒ†ãƒ¼ãƒãƒ‘ãƒ¼ã‚¯',
            'ãƒ˜ãƒªã‚³ãƒ—ã‚¿ãƒ¼éŠè¦§',
            'ãƒ–ãƒ©ãƒ³ãƒ‰ãƒãƒƒã‚°',
            'ã‚¨ã‚¹ãƒ†ãƒ•ãƒ«ã‚³ãƒ¼ã‚¹',
            'ãƒªãƒ ã‚¸ãƒ³ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼',
            'ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ³ã‚°'
        ];

        const TARGET_ITEM = 'ãƒ›ãƒ†ãƒ«å®¿æ³Š';
        const REEL_HEIGHT = 120; // 1ã‚¢ã‚¤ãƒ†ãƒ ã®é«˜ã•(px)

        const reel = document.getElementById('reel');
        const actionBtn = document.getElementById('actionBtn');
        const statusText = document.getElementById('status');
        const coverScreen = document.getElementById('coverScreen');
        const leverArm = document.getElementById('leverArm');
        const resultOverlay = document.getElementById('resultOverlay');
        const finalResultText = document.getElementById('finalResult');
        const surpriseMessage = document.getElementById('surpriseMessage');

        let isSpinning = false;
        let isStopped = false;

        // ãƒªãƒ¼ãƒ«ã®åˆæœŸåŒ–
        function initReel() {
            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã«ãƒªã‚¹ãƒˆã‚’å¤šã‚ã«é€£çµã™ã‚‹
            // å°‘ãªãã¨ã‚‚2ã‚»ãƒƒãƒˆä»¥ä¸Šä½œæˆã—ã€ãƒ«ãƒ¼ãƒ—ã•ã›ã‚‹
            const list = [...giftItems, ...giftItems, ...giftItems]; 
            
            reel.innerHTML = '';
            list.forEach(item => {
                const div = document.createElement('div');
                div.className = 'reel-item';
                div.textContent = item;
                reel.appendChild(div);
            });

            // åˆæœŸä½ç½®èª¿æ•´ï¼ˆè¦‹ãŸç›®ã‚’æ•´ãˆã‚‹ãŸã‚ï¼‰
            reel.style.transform = 'translateY(0px)';
        }

        initReel();

        actionBtn.addEventListener('click', () => {
            if (!isSpinning && !isStopped) {
                startSlot();
            } else if (isSpinning && !isStopped) {
                stopSlot();
            }
        });

        function startSlot() {
            isSpinning = true;
            statusText.textContent = 'SPINNING...';
            
            // ãƒœã‚¿ãƒ³ã®è¦‹ãŸç›®å¤‰æ›´
            actionBtn.textContent = 'STOP!';
            actionBtn.classList.replace('bg-red-500', 'bg-blue-500');
            actionBtn.classList.replace('hover:bg-red-600', 'hover:bg-blue-600');
            actionBtn.classList.replace('border-red-700', 'border-blue-700');

            // ãƒ¬ãƒãƒ¼ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            leverArm.classList.add('pulled');
            setTimeout(() => leverArm.classList.remove('pulled'), 300);

            // ã‚«ãƒãƒ¼ã‚’å¤–ã™
            coverScreen.style.opacity = '0';

            // å›è»¢é–‹å§‹ï¼ˆCSSã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ + ãƒ–ãƒ©ãƒ¼ï¼‰
            document.querySelector('.slot-machine').classList.add('spinning');
        }

        function stopSlot() {
            if (isStopped) return;
            isStopped = true;
            isSpinning = false;
            
            actionBtn.textContent = '...';
            actionBtn.disabled = true;
            statusText.textContent = 'åˆ¤å®šä¸­...';

            // 1. å›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ­¢ã‚ã‚‹
            const slotMachine = document.querySelector('.slot-machine');
            slotMachine.classList.remove('spinning');
            
            // 2. ã‚¤ã‚«ã‚µãƒä½ç½®è¨ˆç®—
            // ä¸€æ—¦ã€ç¾åœ¨ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€
            // ã€Œã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒå°‘ã—ä¸Šã«ã‚ã‚‹çŠ¶æ…‹ã€ã‹ã‚‰ã€Œã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒçœŸã‚“ä¸­ã«æ¥ã‚‹ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹
            
            // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ¢ã™ï¼ˆãƒªã‚¹ãƒˆã®çœŸã‚“ä¸­ã‚ãŸã‚Šã®ã‚»ãƒƒãƒˆã‚’ä½¿ã†ã¨å®‰å…¨ï¼‰
            // giftItemsã®é•·ã•åˆ†ãŒ1ã‚»ãƒƒãƒˆã€‚2ã‚»ãƒƒãƒˆç›®ã®TARGET_ITEMã‚’ç‹™ã†
            const targetIndexInList = giftItems.length + giftItems.indexOf(TARGET_ITEM);
            
            // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸­å¿ƒã«æ¥ã‚‹ãŸã‚ã®translateYã®å€¤
            // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®ä¸Šç«¯ä½ç½® = index * height
            // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸­å¿ƒã«ã‚¢ã‚¤ãƒ†ãƒ ã®ä¸­å¿ƒã‚’æŒã£ã¦ãã‚‹ã«ã¯ã€ã‚¢ã‚¤ãƒ†ãƒ ã®ä¸Šç«¯ãŒ0ã®ä½ç½®ã«æ¥ã‚Œã°ã‚ˆã„ï¼ˆwindow height = item heightãªã®ã§ï¼‰
            // ã¤ã¾ã‚Šã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è¦ç´ ãŒä¸€ç•ªä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚Œã°ã‚ˆã„ã€‚
            const targetPosition = targetIndexInList * REEL_HEIGHT;

            // æ¼”å‡ºï¼šã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®å°‘ã—æ‰‹å‰ï¼ˆä¾‹ãˆã°3ã¤å‰ï¼‰ã‹ã‚‰ã‚¹ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ã—ã¦æ­¢ã¾ã‚‹ã‚ˆã†ã«è¦‹ã›ã‚‹
            const startPosition = targetPosition - (REEL_HEIGHT * 6); // 6ã¤å‰ã‹ã‚‰

            // ãƒªãƒ¼ãƒ«ã®ä½ç½®ã‚’å¼·åˆ¶çš„ã«ã‚¹ã‚¿ãƒ¼ãƒˆä½ç½®ã¸ã‚»ãƒƒãƒˆ
            reel.style.transition = 'none';
            // ç¾åœ¨ã®è¦‹ãŸç›®ã‚’ç„¡è¦–ã—ã¦ã€è¨ˆç®—ã—ãŸã€Œå°‘ã—æ‰‹å‰ã€ã®ä½ç½®ã«ç¬é–“ç§»å‹•ï¼ˆé«˜é€Ÿå›è»¢ä¸­ãªã®ã§ãƒãƒ¬ã«ãã„ï¼‰
            reel.style.transform = `translateY(-${startPosition}px)`;

            // å°‘ã—å¾…ã£ã¦ã‹ã‚‰ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆä½ç½®ã¾ã§æ¸›é€Ÿã—ãªãŒã‚‰ç§»å‹•
            requestAnimationFrame(() => {
                setTimeout(() => {
                    reel.style.transition = 'transform 2.5s cubic-bezier(0.15, 0.9, 0.35, 1.05)'; // ãƒã‚¦ãƒ³ãƒ‰ã™ã‚‹ã‚ˆã†ãªã‚¤ãƒ¼ã‚¸ãƒ³ã‚°
                    reel.style.transform = `translateY(-${targetPosition}px)`;
                }, 50);
            });

            // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã®å‡¦ç†
            reel.addEventListener('transitionend', onStopComplete, { once: true });
        }

        function onStopComplete() {
            statusText.textContent = 'JACKPOT!!';
            statusText.classList.add('animate-pulse');
            
            // çµæœè¡¨ç¤º
            setTimeout(() => {
                showResult(TARGET_ITEM);
            }, 500);
        }

        function showResult(text) {
            finalResultText.textContent = text;
            resultOverlay.classList.add('show');
            createConfetti();
            
            // å°‘ã—é…ã‚Œã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            setTimeout(() => {
                surpriseMessage.classList.add('show');
            }, 1000);
        }

        function resetGame() {
            resultOverlay.classList.remove('show');
            statusText.classList.remove('animate-pulse');
            surpriseMessage.classList.remove('show'); // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éš ã™
            
            // ãƒªã‚»ãƒƒãƒˆ
            reel.style.transition = 'none';
            reel.style.transform = 'translateY(0)';
            coverScreen.style.opacity = '1'; // ã‚«ãƒãƒ¼ã‚’æˆ»ã™
            
            isSpinning = false;
            isStopped = false;
            
            actionBtn.textContent = 'SPIN!';
            actionBtn.classList.replace('bg-blue-500', 'bg-red-500');
            actionBtn.classList.replace('hover:bg-blue-600', 'hover:bg-red-600');
            actionBtn.classList.replace('border-blue-700', 'border-red-700');
            actionBtn.disabled = false;
            statusText.textContent = '';
        }

        function createConfetti() {
            const colors = ['#ff0', '#f0f', '#0ff', '#0f0'];
            for(let i=0; i<60; i++) {
                const el = document.createElement('div');
                el.className = 'confetti';
                el.style.left = Math.random() * 100 + 'vw';
                el.style.backgroundColor = colors[Math.floor(Math.random()*colors.length)];
                el.style.animationDuration = (1 + Math.random()*2) + 's';
                el.style.opacity = Math.random();
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 3000);
            }
        }
    </script>
</body>
</html>